{"ast":null,"code":"import setAuthToken from '../utils/setAuthToken';\nimport axios from 'axios';\nimport setAlert from './alert';\nimport { getCart } from './cart';\nimport { getOrder } from './order'; // user loading\n\nexport const loadUser = () => async dispatch => {\n  if (localStorage.token) {\n    setAuthToken(localStorage.token);\n  }\n\n  try {\n    const res = await axios.get('/api/user/profile');\n    dispatch({\n      type: \"USER_LOADED\",\n      payload: res.data\n    });\n  } catch (err) {\n    dispatch({\n      type: \"AUTH_ERROR\"\n    });\n  }\n}; //user register\n\nexport const register = formData => async dispatch => {\n  const {\n    name,\n    email,\n    password,\n    address,\n    pincode,\n    state,\n    city,\n    phone\n  } = formData;\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  const body = JSON.stringify({\n    name,\n    email,\n    password,\n    address,\n    pincode,\n    state,\n    city,\n    phone\n  });\n\n  try {\n    const res = await axios.post('/api/user', body, config);\n    dispatch({\n      type: \"REGISTER_SUCCESS\",\n      payload: res.data\n    });\n    dispatch(loadUser());\n    dispatch(getCart());\n    dispatch(getOrder());\n  } catch (err) {\n    const errors = err.response.data.errors;\n\n    if (errors) {\n      errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n    }\n\n    dispatch({\n      type: \"REGISTER_FAIL\"\n    });\n  }\n}; //user login\n\nexport const login = formData => async dispatch => {\n  const {\n    email,\n    password\n  } = formData;\n  const config = {\n    headers: {\n      'Content-Type': 'application/json'\n    }\n  };\n  const body = JSON.stringify({\n    email,\n    password\n  });\n\n  try {\n    const res = await axios.post('/api/auth', body, config);\n    dispatch({\n      type: \"LOGIN_SUCCESS\",\n      payload: res.data\n    });\n    dispatch(loadUser());\n    dispatch(getCart());\n    dispatch(getOrder());\n  } catch (err) {\n    const errors = err.response.data.errors;\n\n    if (errors) {\n      errors.forEach(error => dispatch(setAlert(error.msg, 'danger')));\n    }\n\n    dispatch({\n      type: \"LOGIN_FAIL\"\n    });\n  }\n}; //user logout\n\nexport const logout = () => dispatch => {\n  dispatch({\n    type: \"LOGOUT\"\n  });\n  dispatch({\n    type: \"CART_ADDING_FAIL\"\n  });\n  dispatch({\n    type: \"ORDER_ADDING_FAIL\"\n  });\n};","map":{"version":3,"sources":["C:/Users/HP/Desktop/PREPBYTES NEW/EA12/MERN-STACK/Online shopping cart/client/src/action/auth.js"],"names":["setAuthToken","axios","setAlert","getCart","getOrder","loadUser","dispatch","localStorage","token","res","get","type","payload","data","err","register","formData","name","email","password","address","pincode","state","city","phone","config","headers","body","JSON","stringify","post","errors","response","forEach","error","msg","login","logout"],"mappings":"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","sourcesContent":["import setAuthToken from '../utils/setAuthToken';\r\nimport axios from 'axios';\r\nimport setAlert from './alert';\r\nimport {getCart} from './cart';\r\nimport {getOrder} from './order';\r\n\r\n// user loading\r\nexport const loadUser = () =>async dispatch =>{\r\n    if(localStorage.token){\r\n        setAuthToken(localStorage.token);\r\n    }\r\n    try{\r\n        const res = await axios.get('/api/user/profile');\r\n        dispatch({\r\n            type:\"USER_LOADED\",\r\n            payload:res.data\r\n        });      \r\n    }\r\n    catch(err){\r\n        dispatch({\r\n            type:\"AUTH_ERROR\"\r\n        })\r\n    }\r\n};\r\n\r\n//user register\r\nexport const register = formData => async dispatch =>{\r\n    const {name,email,password,address,pincode,state,city,phone} = formData;\r\n    const config = {\r\n        headers:{\r\n            'Content-Type':'application/json'\r\n        }\r\n    }\r\n    const body = JSON.stringify({name,email,password,address,pincode,state,city,phone});\r\n    try{\r\n        const res = await axios.post('/api/user',body,config);\r\n        dispatch({\r\n            type : \"REGISTER_SUCCESS\",\r\n            payload:res.data\r\n        });\r\n        dispatch(loadUser());\r\n        dispatch(getCart());\r\n        dispatch(getOrder());\r\n    }\r\n    catch(err){\r\n        const errors = err.response.data.errors;\r\n        if(errors){\r\n            errors.forEach(error => dispatch(setAlert(error.msg,'danger')))\r\n        }\r\n        dispatch({\r\n            type:\"REGISTER_FAIL\"\r\n        })\r\n    }\r\n    \r\n\r\n}\r\n\r\n//user login\r\n\r\nexport const login = formData => async dispatch =>{\r\n    const {email,password} = formData;\r\n    const config = {\r\n        headers:{\r\n            'Content-Type':'application/json'\r\n        }\r\n    }\r\n    const body = JSON.stringify({email,password});\r\n    try{\r\n        const res = await axios.post('/api/auth',body,config);\r\n        dispatch({\r\n            type : \"LOGIN_SUCCESS\",\r\n            payload:res.data\r\n        });\r\n        dispatch(loadUser());\r\n        dispatch(getCart());\r\n        dispatch(getOrder());\r\n    }\r\n    catch(err){\r\n        const errors = err.response.data.errors;\r\n        if(errors){\r\n            errors.forEach(error => dispatch(setAlert(error.msg,'danger')))\r\n        }\r\n        dispatch({\r\n            type:\"LOGIN_FAIL\"\r\n        })\r\n    \r\n    }\r\n    \r\n}\r\n\r\n//user logout\r\nexport const logout = () => dispatch =>{\r\n    dispatch({\r\n        type:\"LOGOUT\"\r\n    }) ;\r\n    dispatch({\r\n        type:\"CART_ADDING_FAIL\"\r\n    })\r\n    dispatch({\r\n        type:\"ORDER_ADDING_FAIL\"\r\n    })\r\n}"]},"metadata":{},"sourceType":"module"}